/*! bandon 2014-08-14 */ ! function() {
    function a() {
        function a(a) {
            f = a.orders, c()
        }

        function b(a) {
            alert("載入訂購列表失敗！")
        }
        myPost("get-orders", "", a, b)
    }

    function b(a) {
        var b = 0;
        return a.options.forEach(function(a) {
            b += 1 * a.detail.price
        }), 1 * a.kind.price + b
    }

    function c() {
        g = {}, f.forEach(function(a) {
            a.price = b(a), g[a.user_id] || (g[a.user_id] = {
                id: a.user.id,
                name: a.user.name,
                floor: a.user.floor,
                orders: []
            }), g[a.user_id].orders.push(a)
        }), e()
    }

    function d(a) {
        var c = 0;
        return a.forEach(function(a) {
            a.price || (a.price = b(a)), c += a.price * a.number
        }), c
    }

    function e() {
        var a = [];
        f.forEach(function(b) {
            var c = 0,
                d = [];
            b.options.forEach(function(a) {
                c += 1 * a.detail.price, d.push(a.name + (1 * a.detail.price ? "(+" + a.detail.price + ")" : ""))
            }), a.push(T("<tr>				<td>{floor}</td>				<td>{user_id}</td>				<td>{user_name}</td>				<td>{group_name}</td>				<td>{item_kind}</td>				<td>{options}</td>				<td>{price}</td>				<td>{number}</td>							<td>{createDate}</td>			</tr>", {
                floor: b.user.floor.name,
                user_id: b.user.id,
                user_name: b.user.name,
                group_name: b.group.name,
                item_kind: b.item.name + b.kind.name,
                options: d.join(" "),
                price: 1 * b.kind.price + c,
                number: b.number,
                createDate: b.createDate
            }))
        }), $(".order-list").html(a.join("")), a = [];
        for (var b in g) {
            var c = g[b],
                e = d(c.orders);
            a.push(T("<tr>				<td>{floor_name}</td>				<td>{user_id}</td>				<td>{user_name}</td>				<td>{total}</td>			</tr>", {
                floor_name: c.floor.name,
                user_id: c.id,
                user_name: c.name,
                total: e
            }))
        }
        $(".price-list").html(a.join("")), $("table").each(function() {
            sorttable.makeSortable(this)
        })
    }
    var f = null,
        g = null;
    $(document).ready(a)
}();
//# sourceMappingURL=detail.min.js.map