$(function () {

    $('.input-daterange').datepicker({
        startDate: '-3m',
        endDate: '0d',
        format: 'yyyy/mm/dd',
        todayHighlight: true
    });

    $(".submit").click(function () {

        function a(d) {
            var arr = d["order_chart"];

            if (arr.length == 0) {
                alert("No data.");
                return false;
            }

            var tableBody = $("tbody");
            tableBody.html("");
            for (var i = 0; i < arr.length; i++) {
                var obj = arr[i];
                var str = "";
                str = str.concat("<tr>");

                str = str.concat("<td>");
                str = str.concat(obj["user_id"]);
                str = str.concat("</td>");

                str = str.concat("<td>");
                str = str.concat(obj["user_name"]);
                str = str.concat("</td>");

                str = str.concat("<td>");
                str = str.concat(formatDate(obj["cnt"]));
                str = str.concat("</td>");

                str = str.concat("</tr>");

                tableBody.append(str);
            }
        }

        function b() {
            alert("發生錯誤！");
        }

        var data = {
            startDate: $("#startDate").val(),
            endDate: $("#endDate").val()
        };

        return myPost("get-order-chart", data, a, b, this);

    });

    function formatDate(d) {
        return d == null ? 'n/a' : d.substring(0, 10);
    }
});

